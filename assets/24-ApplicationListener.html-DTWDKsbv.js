import{_ as i,c,a as s,b as e,w as p,d as o,r as u,o as r,e as l}from"./app-CKtXyHQO.js";const d={},v={class:"table-of-contents"},k=["src"];function m(t,n){const a=u("router-link");return r(),c("div",null,[n[6]||(n[6]=s("h1",{id:"applicationlistener",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#applicationlistener"},[s("span",null,"ApplicationListener")])],-1)),n[7]||(n[7]=s("blockquote",null,[s("p",null,"Spring的Enent机制。相当于Spring提供的观察者模式。")],-1)),n[8]||(n[8]=s("p",null,[s("strong",null,"目录")],-1)),s("nav",v,[s("ul",null,[s("li",null,[e(a,{to:"#原理分析"},{default:p(()=>n[0]||(n[0]=[l("原理分析")])),_:1})]),s("li",null,[e(a,{to:"#事件"},{default:p(()=>n[1]||(n[1]=[l("事件")])),_:1})]),s("li",null,[e(a,{to:"#发布器"},{default:p(()=>n[2]||(n[2]=[l("发布器")])),_:1})]),s("li",null,[e(a,{to:"#监听"},{default:p(()=>n[3]||(n[3]=[l("监听")])),_:1}),s("ul",null,[s("li",null,[e(a,{to:"#applicationlistener-1"},{default:p(()=>n[4]||(n[4]=[l("ApplicationListener")])),_:1})]),s("li",null,[e(a,{to:"#eventlistener"},{default:p(()=>n[5]||(n[5]=[l("@EventListener")])),_:1})])])])])]),n[9]||(n[9]=s("h2",{id:"原理分析",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#原理分析"},[s("span",null,"原理分析")])],-1)),n[10]||(n[10]=s("p",null,"Spring的事件发布与监听主要由3部分组成。",-1)),n[11]||(n[11]=s("ul",null,[s("li",null,"事件：ApplicationEvent"),s("li",null,"发布器：ApplicationEventPublisher"),s("li",null,"监听：ApplicationListener")],-1)),s("img",{src:t.$withBase("/images/java/springpublisher.png"),alt:"springpublisher"},null,8,k),n[12]||(n[12]=o(`<h2 id="事件" tabindex="-1"><a class="header-anchor" href="#事件"><span>事件</span></a></h2><p>定义一个统一的事件（理解为基类），用于扩展事件</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Getter</span></span>
<span class="line"><span class="token annotation punctuation">@Setter</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MarsAppicationEvent</span> <span class="token keyword">extends</span> <span class="token class-name">ApplicationEvent</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">8965489051151591696L</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">MarsEvent</span> marsEvent<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">MarsAppicationEvent</span><span class="token punctuation">(</span><span class="token class-name">Object</span> source<span class="token punctuation">,</span> <span class="token class-name">MarsEvent</span> marsEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>marsEvent <span class="token operator">=</span> marsEvent<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">MarsAppicationEvent</span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Object</span> source<span class="token punctuation">,</span> <span class="token class-name">MarsEvent</span> marsEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MarsAppicationEvent</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> marsEvent<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>事件这里定义了一个监听器接口，纯粹是为了业务扩展</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MarsEvent</span> <span class="token keyword">extends</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getBusinessId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">default</span> <span class="token class-name">MarsEventType</span> <span class="token function">getEventType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">MarsEventTypeEnum</span><span class="token punctuation">.</span><span class="token constant">BUSINESS</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>监听器接口中使用的事件类型接口和枚举实现</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MarsEventType</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">String</span> <span class="token function">getEventType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Getter</span></span>
<span class="line"><span class="token annotation punctuation">@AllArgsConstructor</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">MarsEventTypeEnum</span> <span class="token keyword">implements</span> <span class="token class-name">MarsEventType</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">BUSINESS</span><span class="token punctuation">(</span><span class="token string">&quot;business&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> eventType<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="发布器" tabindex="-1"><a class="header-anchor" href="#发布器"><span>发布器</span></a></h2><p>使用Spring的<code>ApplicationEventPublisher</code>接口发布事件。</p><p>说明：<code>ApplicationEventPublisher</code>是<code>ApplicationContext</code> 的父接口，所以这里直接使用注入方式，获取Spring提供的实例。定义为<code>static</code>纯粹是为了使用方便（习惯而已）。</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Component</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MarsApplicationPubliser</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ApplicationEventPublisher</span> staticApplicationEventPublisher<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">MarsApplicationPubliser</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEventPublisher</span> applicationEventPublisher<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>staticApplicationEventPublisher <span class="token operator">=</span> applicationEventPublisher<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">publish</span><span class="token punctuation">(</span><span class="token class-name">MarsAppicationEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        staticApplicationEventPublisher<span class="token punctuation">.</span><span class="token function">publishEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="监听" tabindex="-1"><a class="header-anchor" href="#监听"><span>监听</span></a></h2><p>事件监听可以通过<code>ApplicationListener</code>接口或者<code>@EventListener</code>注解方式来实现。</p><h3 id="applicationlistener-1" tabindex="-1"><a class="header-anchor" href="#applicationlistener-1"><span>ApplicationListener</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Slf4j</span></span>
<span class="line"><span class="token annotation punctuation">@Component</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MarsApplicationListener</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MarsAppicationEvent</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token doc-comment comment">/**</span>
<span class="line">     * Handle an application event.</span>
<span class="line">     *</span>
<span class="line">     * <span class="token keyword">@param</span> <span class="token parameter">event</span> the event to respond to</span>
<span class="line">     */</span></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">MarsAppicationEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;监听到 {}&quot;</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">MarsEvent</span> listener <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getMarsEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        listener<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="eventlistener" tabindex="-1"><a class="header-anchor" href="#eventlistener"><span>@EventListener</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Service</span></span>
<span class="line"><span class="token annotation punctuation">@Slf4j</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MarsApplicationListener4Annotation</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token doc-comment comment">/**</span>
<span class="line">     * Handle an application event.</span>
<span class="line">     *</span>
<span class="line">     * <span class="token keyword">@param</span> <span class="token parameter">event</span> the event to respond to</span>
<span class="line">     */</span></span>
<span class="line">    <span class="token annotation punctuation">@EventListener</span><span class="token punctuation">(</span><span class="token class-name">MarsAppicationEvent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">MarsAppicationEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;监听到 {}&quot;</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,17))])}const h=i(d,[["render",m],["__file","24-ApplicationListener.html.vue"]]),y=JSON.parse('{"path":"/docs/java/24-ApplicationListener.html","title":"ApplicationListener","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"原理分析","slug":"原理分析","link":"#原理分析","children":[]},{"level":2,"title":"事件","slug":"事件","link":"#事件","children":[]},{"level":2,"title":"发布器","slug":"发布器","link":"#发布器","children":[]},{"level":2,"title":"监听","slug":"监听","link":"#监听","children":[{"level":3,"title":"ApplicationListener","slug":"applicationlistener-1","link":"#applicationlistener-1","children":[]},{"level":3,"title":"@EventListener","slug":"eventlistener","link":"#eventlistener","children":[]}]}],"git":{"updatedTime":1735614539000,"contributors":[{"name":"wangxiaoquan","email":"wxq","commits":2}]},"filePathRelative":"docs/java/24-ApplicationListener.md"}');export{h as comp,y as data};
