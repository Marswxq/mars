import{_ as n,c as a,d as e,o as t}from"./app-CKtXyHQO.js";const p={};function l(i,s){return t(),a("div",null,s[0]||(s[0]=[e(`<h1 id="winsw" tabindex="-1"><a class="header-anchor" href="#winsw"><span>WinSw</span></a></h1><h2 id="什么是-winsw" tabindex="-1"><a class="header-anchor" href="#什么是-winsw"><span>什么是 WinSw</span></a></h2><p>首先看看 <a href="https://github.com/winsw/winsw/tree/v3" target="_blank" rel="noopener noreferrer">WinSw官方</a>的介绍</p><blockquote><p>WinSW wraps and manages any application as a Windows service.</p></blockquote><p>翻译过来的意思就是，WinSW 可以将<u><strong>任何应用程序</strong></u>&gt;打包并作为 Windows 服务进行管理。</p><p>划重点，Windows 服务可以通过 <code>services.msc</code> 进行管理，随着 Windows 自启动等。</p><h2 id="开始使用-winsw" tabindex="-1"><a class="header-anchor" href="#开始使用-winsw"><span>开始使用 WinSw</span></a></h2><p>WinSw 支持 全局和捆绑两种使用方式</p><blockquote><h2 id="use-winsw-as-a-global-tool" tabindex="-1"><a class="header-anchor" href="#use-winsw-as-a-global-tool"><span>Use WinSW as a global tool</span></a></h2><ul><li>Take WinSW.exe or WinSW.zip from the distribution.</li><li>Write myapp.xml (see the XML config file specification and samples for more details).</li><li>Run winsw install myapp.xml [options] to install the service.</li><li>Run winsw start myapp.xml to start the service.</li><li>Run winsw status myapp.xml to see if your service is up and running.</li></ul><h2 id="use-winsw-as-a-bundled-tool" tabindex="-1"><a class="header-anchor" href="#use-winsw-as-a-bundled-tool"><span>Use WinSW as a bundled tool</span></a></h2><ul><li>Take WinSW.exe or WinSW.zip from the distribution, and rename the .exe to your taste (such as myapp.exe).</li><li>Write myapp.xml (see the XML config file specification and samples for more details).</li><li>Place those two files side by side, because that&#39;s how WinSW discovers its co-related configuration.</li><li>Run myapp.exe install [options] to install the service.</li><li>Run myapp.exe start to start the service.</li></ul></blockquote><p>官方给出了一个 Jenkins 的例子。</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>jenkins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>Jenkins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>This service runs Jenkins continuous integration system.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>JENKINS_HOME<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%BASE%<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>arguments</span><span class="token punctuation">&gt;</span></span>-Xrs -Xmx256m -jar &quot;%BASE%\\jenkins.war&quot; --httpPort=8080<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>arguments</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>roll<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>划重点，通过官方例子可以得出一个结论，只要是在 Windows 下能执行的应用（文件、脚本、.exe 、.bat 、.jar……）都可以通过 WinSw 注册为 Windows 服务。</p><h2 id="如何使用-winsw" tabindex="-1"><a class="header-anchor" href="#如何使用-winsw"><span>如何使用 WinSw</span></a></h2><p>首先通过前面内容可以猜到 WinSw 是通过其配置文件进行管理的。</p><p>WinSw 支持的命令，官方内容如下</p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>install</td><td>Installs the service.</td></tr><tr><td>uninstall</td><td>Uninstalls the service.</td></tr><tr><td>start</td><td>Starts the service.</td></tr><tr><td>stop</td><td>Stops the service.</td></tr><tr><td>restart</td><td>Stops and then starts the service.</td></tr><tr><td>status</td><td>Checks the status of the service.</td></tr><tr><td>refresh</td><td>Refreshes the service properties without reinstallation.</td></tr><tr><td>customize</td><td>Customizes the wrapper executable.</td></tr><tr><td>dev</td><td>Experimental commands.</td></tr></tbody></table><h2 id="使用实例" tabindex="-1"><a class="header-anchor" href="#使用实例"><span>使用实例</span></a></h2><h3 id="_1-nginx" tabindex="-1"><a class="header-anchor" href="#_1-nginx"><span>1. nginx</span></a></h3><p><strong>场景：</strong></p><p>统一认证服务部署在内网，但微信、钉钉等认证需要通过等其官方（公网）的验证才能获取 token 。 此时就需要一台前置服务（nginx）作为内网外往通信的桥梁，但是大家都知道 Windows 运行的不稳定性。 如何确保前置机的稳定运行呢？</p><p><strong>方案：</strong></p><p>把 nginx 作为 Windows 服务来进行管理，随着 Windows 的启动而启动。 PS:如果 Windows 没启动，其他都不用谈了~~~</p><p>首先，创建一个 nginx-service.xml 配置文件</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token comment">&lt;!-- nginx-service.xml --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>nginx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>nginx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>nginx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>startmode</span><span class="token punctuation">&gt;</span></span>Automatic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>startmode</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>%BASE%\\nginx.exe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logpath</span><span class="token punctuation">&gt;</span></span>%BASE%\\logs\\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logpath</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>append<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>rotate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其次，将 WinSw.exe 重命名为 nginx-service.xml</p><p>然后，安装 nginx 服务</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">nginx-service.exe <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>最后，启动 nginx 服务</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">nginx-service start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>为了方便使用，可以把管理命令作为脚本。</p><p>部署脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># instal.bat</span></span>
<span class="line">@echo off</span>
<span class="line">:color 2f</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">mode con: <span class="token assign-left variable">cols</span><span class="token operator">=</span><span class="token number">80</span> <span class="token assign-left variable">lines</span><span class="token operator">=</span><span class="token number">25</span></span>
<span class="line"><span class="token builtin class-name">echo</span> 请按任意键开始安装后台服务<span class="token punctuation">..</span>.<span class="token operator">&amp;</span>pause<span class="token operator">&gt;</span>nul</span>
<span class="line"></span>
<span class="line">nginx-service.exe <span class="token function">install</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> 部署完成！</span>
<span class="line">echo.</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># start.bat</span></span>
<span class="line">@echo off</span>
<span class="line">:color 2f</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">mode con: <span class="token assign-left variable">cols</span><span class="token operator">=</span><span class="token number">80</span> <span class="token assign-left variable">lines</span><span class="token operator">=</span><span class="token number">25</span></span>
<span class="line"><span class="token builtin class-name">echo</span> 请按任意键开始启动nginx后台服务<span class="token punctuation">..</span>.<span class="token operator">&amp;</span>pause<span class="token operator">&gt;</span>nul</span>
<span class="line"></span>
<span class="line">nginx-service start</span>
<span class="line"></span>
<span class="line">echo.</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> nginx进程</span>
<span class="line">tasklist /fi <span class="token string">&quot;imagename eq nginx.exe&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> 请确认nginx进程是否存在，如进程未正常打印，请检查nginx安装目录下logs目录下日志，并重新启动</span>
<span class="line">echo.</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> 启动完成！</span>
<span class="line">echo.</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>停止脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># stop.bat</span></span>
<span class="line">@echo off</span>
<span class="line">:color 2f</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">mode con: <span class="token assign-left variable">cols</span><span class="token operator">=</span><span class="token number">80</span> <span class="token assign-left variable">lines</span><span class="token operator">=</span><span class="token number">25</span></span>
<span class="line"><span class="token builtin class-name">echo</span> 请按任意键开始停止nginx后台服务<span class="token punctuation">..</span>.<span class="token operator">&amp;</span>pause<span class="token operator">&gt;</span>nul</span>
<span class="line"></span>
<span class="line">%1 mshta vbscript:CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Shell.Application&quot;</span><span class="token punctuation">)</span>.ShellExecute<span class="token punctuation">(</span><span class="token string">&quot;cmd.exe&quot;</span>,<span class="token string">&quot;/c %~s0 ::&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;runas&quot;</span>,1<span class="token punctuation">)</span><span class="token punctuation">(</span>window.close<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">exit</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">cd</span> /d <span class="token string">&quot;%~dp0&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> nginx进程</span>
<span class="line">tasklist /fi <span class="token string">&quot;imagename eq nginx.exe&quot;</span></span>
<span class="line"></span>
<span class="line">echo.</span>
<span class="line">taskkill /f /fi <span class="token string">&quot;IMAGENAME eq nginx.exe*&quot;</span></span>
<span class="line"></span>
<span class="line">echo.</span>
<span class="line"><span class="token builtin class-name">echo</span> 请确认nginx进程是否存在，如进程依然存在，请检查nginx安装目录下logs目录下日志，并重新停止</span>
<span class="line">echo.</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> 停止完成！</span>
<span class="line">echo.</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>卸载脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># uninstall.bat</span></span>
<span class="line">@echo off</span>
<span class="line">:color 2f</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">mode con: <span class="token assign-left variable">cols</span><span class="token operator">=</span><span class="token number">80</span> <span class="token assign-left variable">lines</span><span class="token operator">=</span><span class="token number">25</span></span>
<span class="line"><span class="token builtin class-name">echo</span> 请按任意键开始卸载nginx后台服务<span class="token punctuation">..</span>.<span class="token operator">&amp;</span>pause<span class="token operator">&gt;</span>nul</span>
<span class="line"></span>
<span class="line">.<span class="token punctuation">\\</span>nginx-service.exe uninstall</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> 卸载完成！</span>
<span class="line">echo.</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-jar" tabindex="-1"><a class="header-anchor" href="#_2-jar"><span>2. jar</span></a></h3><p>配置文件</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--安装成Windows服务后的服务名--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>hcbp-devops-warnning<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--显示的服务名称--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hcbp-devops-warnning<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--对服务的描述--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>hcbp-devops-warnning<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>HCBP_JRE_HOME<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%Base%<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>arguments</span><span class="token punctuation">&gt;</span></span>-jar .\\hcbp-devops-warnning.jar -Xmx512m -Xms512m</span>
<span class="line">        --spring.config.additional-location=.\\hcbp-devops-warnning.yml</span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>arguments</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--让服务自动启动--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>startmode</span><span class="token punctuation">&gt;</span></span>Automatic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>startmode</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--日志路径--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logpath</span><span class="token punctuation">&gt;</span></span>./logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logpath</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--日志模式--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>roll-by-size-time<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sizeThreshold</span><span class="token punctuation">&gt;</span></span>10240<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sizeThreshold</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>yyyyMMdd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>autoRollAtTime</span><span class="token punctuation">&gt;</span></span>00:00:00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>autoRollAtTime</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>zipOlderThanNumDays</span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>zipOlderThanNumDays</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>zipDateFormat</span><span class="token punctuation">&gt;</span></span>yyyyMM<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>zipDateFormat</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>部署脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">@echo off</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">setlocal enabledelayedexpansion</span>
<span class="line"><span class="token builtin class-name">echo</span> 开始配置java环境</span>
<span class="line"><span class="token builtin class-name">set</span> <span class="token string">&quot;HCBP_JRE_HOME=%cd%\\jre-1.8-x32&quot;</span></span>
<span class="line"><span class="token builtin class-name">echo</span> 环境变量添加HCBP_JRE_HOME</span>
<span class="line">setx /m HCBP_JRE_HOME %cd%<span class="token punctuation">\\</span>jre-1.8-x32 <span class="token operator">&gt;</span> nul</span>
<span class="line"><span class="token builtin class-name">set</span> <span class="token string">&quot;newPath=%HCBP_JRE_HOME%<span class="token entity" title="\\b">\\b</span>in&quot;</span></span>
<span class="line"><span class="token builtin class-name">echo</span> %<span class="token environment constant">PATH</span>% <span class="token operator">|</span> findstr /C:<span class="token string">&quot;%newPath%&quot;</span> <span class="token operator">&gt;</span> nul</span>
<span class="line"><span class="token keyword">if</span> %errorlevel% <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token environment constant">PATH</span>中HCBP_JRE_HOME已存在，正在替换<span class="token punctuation">..</span>.</span>
<span class="line">    <span class="token builtin class-name">set</span> <span class="token string">&quot;newPathList=&quot;</span></span>
<span class="line">    <span class="token keyword">for</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>%<span class="token environment constant">PATH</span>%<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token keyword">if</span> /I <span class="token string">&quot;%%i&quot;</span><span class="token operator">==</span><span class="token string">&quot;%newPath%&quot;</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token builtin class-name">set</span> <span class="token string">&quot;newPathList=!newPathList!;%%i&quot;</span></span>
<span class="line">        <span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token builtin class-name">set</span> <span class="token string">&quot;newPathList=!newPathList!;%%i&quot;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">    rem 添加新路径</span>
<span class="line">    <span class="token builtin class-name">set</span> <span class="token string">&quot;newPathList=!newPathList!;%newPath%&quot;</span></span>
<span class="line">    setx <span class="token environment constant">PATH</span> <span class="token string">&quot;!newPathList:~1!&quot;</span> <span class="token operator">&gt;</span>nul</span>
<span class="line"><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token environment constant">PATH</span>中HCBP_JRE_HOME不存在，正在替换<span class="token punctuation">..</span>.</span>
<span class="line">    setx /m <span class="token environment constant">PATH</span> <span class="token string">&quot;%PATH%;%newPath%&quot;</span> <span class="token operator">&gt;</span>nul</span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token builtin class-name">echo</span> java环境配置完成！</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> 部署hcbp-devops-warnning</span>
<span class="line">hcbp-devops-warnning.exe <span class="token function">install</span></span>
<span class="line"><span class="token builtin class-name">echo</span> 部署完成！</span>
<span class="line">echo.</span>
<span class="line">endlocal</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">@echo off</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">hcbp-devops-warnning.exe start</span>
<span class="line">echo.</span>
<span class="line"><span class="token builtin class-name">echo</span> 日志路径：%cd%<span class="token punctuation">\\</span>logs</span>
<span class="line"><span class="token builtin class-name">echo</span> 验证：http://127.0.0.1:10001/warnning/doc.html<span class="token comment">#/home</span></span>
<span class="line">echo.</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>停止脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">@echo off</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">hcbp-devops-warnning.exe stop</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>卸载脚本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">@echo off</span>
<span class="line">chcp <span class="token number">65001</span></span>
<span class="line">hcbp-devops-warnning.exe uninstall</span>
<span class="line">pause</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,49)]))}const o=n(p,[["render",l],["__file","06-WinSw.html.vue"]]),u=JSON.parse('{"path":"/docs/other/06-WinSw.html","title":"WinSw","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"什么是 WinSw","slug":"什么是-winsw","link":"#什么是-winsw","children":[]},{"level":2,"title":"开始使用 WinSw","slug":"开始使用-winsw","link":"#开始使用-winsw","children":[]},{"level":2,"title":"如何使用 WinSw","slug":"如何使用-winsw","link":"#如何使用-winsw","children":[]},{"level":2,"title":"使用实例","slug":"使用实例","link":"#使用实例","children":[{"level":3,"title":"1. nginx","slug":"_1-nginx","link":"#_1-nginx","children":[]},{"level":3,"title":"2. jar","slug":"_2-jar","link":"#_2-jar","children":[]}]}],"git":{"updatedTime":1745763186000,"contributors":[{"name":"wangxiaoquan","email":"wxq","commits":1}]},"filePathRelative":"docs/other/06-WinSw.md"}');export{o as comp,u as data};
