import{_ as p,c as i,a as s,b as e,w as l,d as c,r as o,o as d,e as t}from"./app-CKtXyHQO.js";const u={},r={class:"table-of-contents"};function v(g,n){const a=o("router-link");return d(),i("div",null,[n[8]||(n[8]=s("h1",{id:"excel",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#excel"},[s("span",null,"Excel")])],-1)),n[9]||(n[9]=s("p",null,[s("strong",null,"目录")],-1)),s("nav",r,[s("ul",null,[s("li",null,[e(a,{to:"#easyexcel"},{default:l(()=>n[0]||(n[0]=[t("EasyExcel")])),_:1}),s("ul",null,[s("li",null,[e(a,{to:"#pom依赖"},{default:l(()=>n[1]||(n[1]=[t("POM依赖")])),_:1})]),s("li",null,[e(a,{to:"#读excel"},{default:l(()=>n[2]||(n[2]=[t("读Excel")])),_:1})]),s("li",null,[e(a,{to:"#写excel"},{default:l(()=>n[3]||(n[3]=[t("写Excel")])),_:1})]),s("li",null,[e(a,{to:"#web上传、下载"},{default:l(()=>n[4]||(n[4]=[t("web上传、下载")])),_:1})])])]),s("li",null,[e(a,{to:"#附录"},{default:l(()=>n[5]||(n[5]=[t("附录")])),_:1})]),s("li",null,[e(a,{to:"#案例"},{default:l(()=>n[6]||(n[6]=[t("案例")])),_:1}),s("ul",null,[s("li",null,[e(a,{to:"#自定义转换类"},{default:l(()=>n[7]||(n[7]=[t("自定义转换类")])),_:1})])])])])]),n[10]||(n[10]=c(`<h2 id="easyexcel" tabindex="-1"><a class="header-anchor" href="#easyexcel"><span>EasyExcel</span></a></h2><blockquote><p>EasyExcel是一个基于Java的简单、省内存的读写Excel的开源项目。在尽可能节约内存的情况下支持读写百M的Excel。</p></blockquote><p><a href="https://easyexcel.opensource.alibaba.com/docs/current/" target="_blank" rel="noopener noreferrer">官方文档</a></p><h3 id="pom依赖" tabindex="-1"><a class="header-anchor" href="#pom依赖"><span>POM依赖</span></a></h3><div class="language-XML line-numbers-mode" data-highlighter="prismjs" data-ext="XML" data-title="XML"><pre><code><span class="line">&lt;dependency&gt;</span>
<span class="line">    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span>
<span class="line">    &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;</span>
<span class="line">    &lt;version&gt;2.2.10&lt;/version&gt;</span>
<span class="line">&lt;/dependency&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：POI版本需要和EasyExcel中jar版本对应</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencys</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!-- xls格式excel依赖包 --&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!--xlsx格式excel依赖包--&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi-ooxml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi-ooxml-schemas<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cglib<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cglib<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token comment">&lt;!-- easyexcel依赖包 --&gt;</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>easyexcel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencys</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="读excel" tabindex="-1"><a class="header-anchor" href="#读excel"><span>读Excel</span></a></h3><div class="language-Java line-numbers-mode" data-highlighter="prismjs" data-ext="Java" data-title="Java"><pre><code><span class="line">/**</span>
<span class="line"> * 最简单的读</span>
<span class="line"> * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link DemoData}</span>
<span class="line"> * &lt;p&gt;2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照{@link DemoDataListener}</span>
<span class="line"> * &lt;p&gt;3. 直接读即可</span>
<span class="line"> */</span>
<span class="line">@Test</span>
<span class="line">public void simpleRead() {</span>
<span class="line">    String fileName = TestFileUtil.getPath() + &quot;demo&quot; + File.separator + &quot;demo.xlsx&quot;;</span>
<span class="line">    // 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span>
<span class="line">    EasyExcel.read(fileName, DemoData.class, new DemoDataListener()).sheet().doRead();</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="写excel" tabindex="-1"><a class="header-anchor" href="#写excel"><span>写Excel</span></a></h3><div class="language-Java line-numbers-mode" data-highlighter="prismjs" data-ext="Java" data-title="Java"><pre><code><span class="line">/**</span>
<span class="line"> * 最简单的写</span>
<span class="line"> * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link com.alibaba.easyexcel.test.demo.write.DemoData}</span>
<span class="line"> * &lt;p&gt;2. 直接写即可</span>
<span class="line"> */</span>
<span class="line">@Test</span>
<span class="line">public void simpleWrite() {</span>
<span class="line">    String fileName = TestFileUtil.getPath() + &quot;write&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
<span class="line">    // 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span>
<span class="line">    // 如果这里想使用03 则 传入excelType参数即可</span>
<span class="line">    EasyExcel.write(fileName, DemoData.class).sheet(&quot;模板&quot;).doWrite(data());</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="web上传、下载" tabindex="-1"><a class="header-anchor" href="#web上传、下载"><span>web上传、下载</span></a></h3><div class="language-Java line-numbers-mode" data-highlighter="prismjs" data-ext="Java" data-title="Java"><pre><code><span class="line"> /**</span>
<span class="line"> * 文件下载（失败了会返回一个有部分数据的Excel）</span>
<span class="line"> * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link DownloadData}</span>
<span class="line"> * &lt;p&gt;2. 设置返回的 参数</span>
<span class="line"> * &lt;p&gt;3. 直接写，这里注意，finish的时候会自动关闭OutputStream,当然你外面再关闭流问题不大</span>
<span class="line"> */</span>
<span class="line">@GetMapping(&quot;download&quot;)</span>
<span class="line">public void download(HttpServletResponse response) throws IOException {</span>
<span class="line">    // 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman</span>
<span class="line">    response.setContentType(&quot;application/vnd.ms-excel&quot;);</span>
<span class="line">    response.setCharacterEncoding(&quot;utf-8&quot;);</span>
<span class="line">    // 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span>
<span class="line">    String fileName = URLEncoder.encode(&quot;测试&quot;, &quot;UTF-8&quot;);</span>
<span class="line">    response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename=&quot; + fileName + &quot;.xlsx&quot;);</span>
<span class="line">    EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet(&quot;模板&quot;).doWrite(data());</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">/**</span>
<span class="line"> * 文件上传</span>
<span class="line"> * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link UploadData}</span>
<span class="line"> * &lt;p&gt;2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照{@link UploadDataListener}</span>
<span class="line"> * &lt;p&gt;3. 直接读即可</span>
<span class="line"> */</span>
<span class="line">@PostMapping(&quot;upload&quot;)</span>
<span class="line">@ResponseBody</span>
<span class="line">public String upload(MultipartFile file) throws IOException {</span>
<span class="line">    EasyExcel.read(file.getInputStream(), UploadData.class, new UploadDataListener(uploadDAO)).sheet().doRead();</span>
<span class="line">    return &quot;success&quot;;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="附录" tabindex="-1"><a class="header-anchor" href="#附录"><span>附录</span></a></h2><p><a href="https://easyexcel.opensource.alibaba.com/docs/current/" target="_blank" rel="noopener noreferrer">EasyExcel官方文档</a></p><h2 id="案例" tabindex="-1"><a class="header-anchor" href="#案例"><span>案例</span></a></h2><h3 id="自定义转换类" tabindex="-1"><a class="header-anchor" href="#自定义转换类"><span>自定义转换类</span></a></h3><p>以枚举为例，其他都大同小异</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,19))])}const m=p(u,[["render",v],["__file","10-Excel.html.vue"]]),b=JSON.parse('{"path":"/docs/java/10-Excel.html","title":"Excel","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"EasyExcel","slug":"easyexcel","link":"#easyexcel","children":[{"level":3,"title":"POM依赖","slug":"pom依赖","link":"#pom依赖","children":[]},{"level":3,"title":"读Excel","slug":"读excel","link":"#读excel","children":[]},{"level":3,"title":"写Excel","slug":"写excel","link":"#写excel","children":[]},{"level":3,"title":"web上传、下载","slug":"web上传、下载","link":"#web上传、下载","children":[]}]},{"level":2,"title":"附录","slug":"附录","link":"#附录","children":[]},{"level":2,"title":"案例","slug":"案例","link":"#案例","children":[{"level":3,"title":"自定义转换类","slug":"自定义转换类","link":"#自定义转换类","children":[]}]}],"git":{"updatedTime":1740890627000,"contributors":[{"name":"wangxiaoquan","email":"wxq","commits":2}]},"filePathRelative":"docs/java/10-Excel.md"}');export{m as comp,b as data};
