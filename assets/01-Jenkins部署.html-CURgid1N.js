import{_ as e,c as a,d as i,o as l}from"./app-CKtXyHQO.js";const t="/mars/images/jenkins/jenkins_password.png",r="/mars/images/jenkins/jenkins1.png",p="/mars/images/jenkins/jenkins2.png",d="/mars/images/jenkins/jenkins3.png",c="/mars/images/jenkins/jenkins4.png",o="/mars/images/jenkins/jenkins5.png",m="/mars/images/jenkins/jenkins6.png",h="/mars/images/jenkins/jenkins7.png",k="/mars/images/jenkins/jenkins_setting.png",g="/mars/images/jenkins/jenkins_setting_system.png",u="/mars/images/jenkins/jenkins_setting_system_git.png",v="/mars/images/jenkins/jenkins_setting_system_plugins.png",j="/mars/images/jenkins/jenkins_setting_system_plugins_node.png",_="/mars/images/jenkins/jenkins_setting_system_plugins_node1.png",s="/mars/images/jenkins/jenkins_setting_system_plugins_maven.png",b="/mars/images/jenkins/jenkins_setting_tool.png",f="/mars/images/jenkins/jenkins_setting_system_macven1.png",x="/mars/images/jenkins/jenkins_setting_system_plugins_maven1.png",y="/mars/images/jenkins/jenkins_setting_system_noed.png",q="/mars/images/jenkins/jenkins_login.png",J={};function w(N,n){return l(),a("div",null,n[0]||(n[0]=[i(`<h1 id="jenkins-部署" tabindex="-1"><a class="header-anchor" href="#jenkins-部署"><span>Jenkins 部署</span></a></h1><blockquote><p>本文以 docker 部署方式为例</p></blockquote><h2 id="拉取镜像" tabindex="-1"><a class="header-anchor" href="#拉取镜像"><span>拉取镜像</span></a></h2><blockquote><p>因为众说周知的原因，dockerhub 上不去，本文中镜像都以 <code>https://docker.aityp.com/</code> 提供的代理镜像为例</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">docker</span> pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/jenkins/inbound-agent:latest-jdk17</span>
<span class="line"><span class="token function">docker</span> tag  swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/jenkins/inbound-agent:latest-jdk17  docker.io/jenkins/inbound-agent:latest-jdk17</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="准备-docker-运行环境" tabindex="-1"><a class="header-anchor" href="#准备-docker-运行环境"><span>准备 docker 运行环境</span></a></h2><h3 id="创建挂载目录" tabindex="-1"><a class="header-anchor" href="#创建挂载目录"><span>创建挂载目录</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /data/jenkins/jenkins_home /data/jenkins/tool</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="创建-jenkins-用户" tabindex="-1"><a class="header-anchor" href="#创建-jenkins-用户"><span>创建 jenkins 用户</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">useradd</span> <span class="token parameter variable">-g</span> <span class="token function">docker</span> jenkins</span>
<span class="line"><span class="token comment"># 或</span></span>
<span class="line"><span class="token function">usermod</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-G</span> <span class="token function">docker</span> jenkins</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em><strong>注意：</strong></em> 如果 jenkins 容器运行时没有 jenkins_home 权限，可以暴力的给其他用户个 7 的权限，<code>chmod 747 /data/jenkins/jenkins_home</code></p><h3 id="下载-maven" tabindex="-1"><a class="header-anchor" href="#下载-maven"><span>下载 maven</span></a></h3><p>按照使用需求下载 <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener noreferrer">maven</a></p><h3 id="上传-maven" tabindex="-1"><a class="header-anchor" href="#上传-maven"><span>上传 maven</span></a></h3><p>将下载好的 maven 上传到 <code>/data/jenkins/tool/</code> 下，并解压</p><h3 id="安装-git" tabindex="-1"><a class="header-anchor" href="#安装-git"><span>安装 git</span></a></h3><p>在宿主机下载 Git 并安装（网上例子太多，此处省略。。。）</p><h2 id="部署-docker" tabindex="-1"><a class="header-anchor" href="#部署-docker"><span>部署 docker</span></a></h2><h3 id="编写-yml" tabindex="-1"><a class="header-anchor" href="#编写-yml"><span>编写 yml</span></a></h3><p>本文以 stack 脚本为例，如果使用 <code>docker run</code>,<code>docker-compose</code> 自行转换即可</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">cat</span> <span class="token operator">&gt;</span> /data/jenkins/ds-jenkins.yml <span class="token operator">&lt;&lt;</span> <span class="token string">&#39;EOF&#39;</span>
<span class="line">version: &#39;3.8&#39;</span>
<span class="line">services:</span>
<span class="line">  jenkins:</span>
<span class="line">    hostname: &quot;jenkins&quot;</span>
<span class="line">    environment:</span>
<span class="line">      - TZ=Asia/Shanghai</span>
<span class="line">      - JAVA_OPTS=-server -Xms5000m -Xmx5000m -XX:MaxNewSize=256m -XX:PermSize=128m -XX:MaxPermSize=256m</span>
<span class="line">    volumes:</span>
<span class="line">      - &quot;/data/jenkins/jenkins_home:/var/jenkins_home&quot;</span>
<span class="line">      - &quot;/data/jenkins/tool:/usr/local/maven&quot;</span>
<span class="line">      - &quot;/var/run/docker.sock:/var/run/docker.sock&quot;</span>
<span class="line">      - &quot;/usr/bin/docker:/usr/bin/docker&quot;</span>
<span class="line">    image: &quot;jenkins/jenkins:2.475&quot;</span>
<span class="line">    ports:</span>
<span class="line">      - &quot;9080:8080&quot;</span>
<span class="line">    deploy:</span>
<span class="line">      mode: replicated</span>
<span class="line">      replicas: 1</span>
<span class="line">      resources:</span>
<span class="line">        limits:</span>
<span class="line">          memory: 6144M</span>
<span class="line">EOF</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="部署-docker-容器" tabindex="-1"><a class="header-anchor" href="#部署-docker-容器"><span>部署 docker 容器</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">docker</span> stack deploy --with-registry-auth <span class="token parameter variable">-c</span> /data/jenkins/ds-jenkins.yml devops</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>检查服务是否正常，如下内容说明服务启动成功</p><p><img src="`+t+'" alt="jenkins部署"></p><p>控制台输出了一个 jenkins 的初始密码，用于 jenkins 初始配置（解锁 jenkins）</p><p><strong>Tips:~~</strong> 至此，jenkins docker 容器部署完成。</p><h2 id="jenkins-安装配置" tabindex="-1"><a class="header-anchor" href="#jenkins-安装配置"><span>Jenkins 安装配置</span></a></h2><p>登录 jenkins 控制台：<code>http://[服务器ip]:9080</code></p><h3 id="解锁-jenkins" tabindex="-1"><a class="header-anchor" href="#解锁-jenkins"><span>解锁 jenkins</span></a></h3><p>此处使用[部署 docker 容器](#部署 docker 容器)中产生的初始密码。</p><p><img src="'+r+'" alt="初始密码"></p><h3 id="安装插件" tabindex="-1"><a class="header-anchor" href="#安装插件"><span>安装插件</span></a></h3><p><img src="'+p+'" alt="安装插件1"></p><p>耐心等待。。。</p><p><img src="'+d+'" alt="安装插件2"></p><h3 id="配置管理员" tabindex="-1"><a class="header-anchor" href="#配置管理员"><span>配置管理员</span></a></h3><p><img src="'+c+'" alt="配置管理员"></p><p>填写管理员账号、密码、邮箱等信息</p><p><img src="'+o+'" alt="管理员信息"></p><h3 id="实例配置" tabindex="-1"><a class="header-anchor" href="#实例配置"><span>实例配置</span></a></h3><p>默认即可</p><p><img src="'+m+'" alt="实例配置"></p><h3 id="完成" tabindex="-1"><a class="header-anchor" href="#完成"><span>完成</span></a></h3><p><img src="'+h+'" alt="完成配置"></p><h2 id="jenkins-使用配置" tabindex="-1"><a class="header-anchor" href="#jenkins-使用配置"><span>Jenkins 使用配置</span></a></h2><p>登录 jenkins 控制台：<code>http://[服务器ip]:9080</code></p><h3 id="系统配置" tabindex="-1"><a class="header-anchor" href="#系统配置"><span>系统配置</span></a></h3><p>进入设置页面</p><p><img src="'+k+'" alt="jenkins 使用配置"></p><p>系统配置</p><p><img src="'+g+'" alt="系统配置"></p><p>git 用户配置</p><p><img src="'+u+'" alt="git 用户配置"></p><h3 id="系统插件" tabindex="-1"><a class="header-anchor" href="#系统插件"><span>系统插件</span></a></h3><p><img src="'+v+'" alt="系统插件"></p><p>安装 NodeJs</p><p><img src="'+j+'" alt="安装 NodeJs"></p><p><img src="'+_+'" alt="安装 NodeJs1"></p><p>安装 Maven</p><p><img src="'+s+'" alt="安装 NodeJs1"></p><p><em><strong>注意：</strong></em> 安装完插件需要重启 jenkins ， 推荐勾选 “安装完成后重启 jenkins （空闲时）”</p><h3 id="全局配置" tabindex="-1"><a class="header-anchor" href="#全局配置"><span>全局配置</span></a></h3><p><img src="'+b+'" alt="全局配置"></p><p>maven 配置</p><p><img src="'+f+'" alt="maven 配置"></p><h3 id="setting-配置" tabindex="-1"><a class="header-anchor" href="#setting-配置"><span>setting 配置</span></a></h3><p><img src="'+s+'" alt="setting 配置"></p><p><img src="'+x+'" alt="setting 配置1"></p><h3 id="node-配置" tabindex="-1"><a class="header-anchor" href="#node-配置"><span>node 配置</span></a></h3><p><img src="'+y+'" alt="node 配置1"></p><h3 id="登录" tabindex="-1"><a class="header-anchor" href="#登录"><span>登录</span></a></h3><p><img src="'+q+'" alt="登录"></p><p><strong>Tips:~~</strong> 至此，jenkins 安装、配置完成，祝您旅途愉快~~~</p>',74)]))}const S=e(J,[["render",w],["__file","01-Jenkins部署.html.vue"]]),E=JSON.parse('{"path":"/docs/jenkins/01-Jenkins%E9%83%A8%E7%BD%B2.html","title":"Jenkins 部署","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"拉取镜像","slug":"拉取镜像","link":"#拉取镜像","children":[]},{"level":2,"title":"准备 docker 运行环境","slug":"准备-docker-运行环境","link":"#准备-docker-运行环境","children":[{"level":3,"title":"创建挂载目录","slug":"创建挂载目录","link":"#创建挂载目录","children":[]},{"level":3,"title":"创建 jenkins 用户","slug":"创建-jenkins-用户","link":"#创建-jenkins-用户","children":[]},{"level":3,"title":"下载 maven","slug":"下载-maven","link":"#下载-maven","children":[]},{"level":3,"title":"上传 maven","slug":"上传-maven","link":"#上传-maven","children":[]},{"level":3,"title":"安装 git","slug":"安装-git","link":"#安装-git","children":[]}]},{"level":2,"title":"部署 docker","slug":"部署-docker","link":"#部署-docker","children":[{"level":3,"title":"编写 yml","slug":"编写-yml","link":"#编写-yml","children":[]},{"level":3,"title":"部署 docker 容器","slug":"部署-docker-容器","link":"#部署-docker-容器","children":[]}]},{"level":2,"title":"Jenkins 安装配置","slug":"jenkins-安装配置","link":"#jenkins-安装配置","children":[{"level":3,"title":"解锁 jenkins","slug":"解锁-jenkins","link":"#解锁-jenkins","children":[]},{"level":3,"title":"安装插件","slug":"安装插件","link":"#安装插件","children":[]},{"level":3,"title":"配置管理员","slug":"配置管理员","link":"#配置管理员","children":[]},{"level":3,"title":"实例配置","slug":"实例配置","link":"#实例配置","children":[]},{"level":3,"title":"完成","slug":"完成","link":"#完成","children":[]}]},{"level":2,"title":"Jenkins 使用配置","slug":"jenkins-使用配置","link":"#jenkins-使用配置","children":[{"level":3,"title":"系统配置","slug":"系统配置","link":"#系统配置","children":[]},{"level":3,"title":"系统插件","slug":"系统插件","link":"#系统插件","children":[]},{"level":3,"title":"全局配置","slug":"全局配置","link":"#全局配置","children":[]},{"level":3,"title":"setting 配置","slug":"setting-配置","link":"#setting-配置","children":[]},{"level":3,"title":"node 配置","slug":"node-配置","link":"#node-配置","children":[]},{"level":3,"title":"登录","slug":"登录","link":"#登录","children":[]}]}],"git":{"updatedTime":1735018240000,"contributors":[{"name":"wangxiaoquan","email":"wxq","commits":1}]},"filePathRelative":"docs/jenkins/01-Jenkins部署.md"}');export{S as comp,E as data};
